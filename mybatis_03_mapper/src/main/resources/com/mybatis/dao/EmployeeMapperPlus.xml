<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.dao.EmployeeMapperPlus">

	<!--自定义某个javaBean的封装规则
	type：自定义规则的Java类型
	id:唯一id方便引用
	  -->
	<resultMap type="com.mybatis.bean.Employee" id="MySimpleEmp">
		<!--指定主键列的封装规则
		id定义主键会底层有优化；
		column：指定哪一列
		property：指定对应的javaBean属性
		  -->
		<id column="id" property="id"/>
		<!-- 定义普通列封装规则 -->
		<result column="last_name" property="lastName"/>
		<!-- 其他不指定的列会自动封装：我们一般只要写resultMap就把全部的映射规则都写上。 -->
		<result column="email" property="email"/>
		<result column="gender" property="gender"/>
	</resultMap>
	
	<!-- resultMap:自定义结果集映射规则；  -->
	<!-- public Employee getEmpById(Integer id); -->
	<select id="getEmpById"  resultMap="MySimpleEmp">
		select * from tbl_employee where id=#{id}
	</select>
	
	<!--
		联合查询：级联属性封装结果集
	  -->
	<resultMap type="com.mybatis.bean.Employee" id="MyDifEmp">
		<id column="id" property="id"/>
		<result column="last_name" property="lastName"/>
		<result column="email" property="email"/>
		<result column="gender" property="gender"/>
		<result column="did" property="dept.id"/>
		<result column="dept_name" property="dept.deptName" />
	</resultMap>
	
	<resultMap type="com.mybatis.bean.Employee" id="MyDifEmp2">
		<id column="id" property="id"/>
		<result column="last_name" property="lastName"/>
		<result column="email" property="email"/>
		<result column="gender" property="gender"/>
		
		<!--  association可以指定联合的javaBean对象
		property="dept"：指定哪个属性是联合的对象
		javaType:指定这个属性对象的类型[不能省略]
		-->
		<association property="dept" javaType="com.mybatis.bean.Dept">
			<id property="id" column="id" />
			<result property="deptName" column="dept_name" />
		</association>
	</resultMap>
	
	<!-- public Employee getEmpAndDept(Integer id); -->
	<select id="getEmpAndDept"  resultMap="MyDifEmp2">
		select 
			e.id, last_name, gender, email, e.d_id did, dept_name from tbl_employee e, dept d 
		where 
			e.d_id = d.id and e.id = #{id}
	</select>
	
	<resultMap type="com.mybatis.bean.Employee" id="MyEmpByStep">
		<id column="id" property="id"/>
		<result column="last_name" property="lastName"/>
		<result column="email" property="email"/>
		<result column="gender" property="gender"/>
		
		<association property="dept" select="com.mybatis.dao.DepartmentMapper.getDeptById" column="id">
		
		</association>
	</resultMap>
	
	<!-- public Employee getDeptByIdStep(Integer id); -->
	<select id="getDeptByIdStep"  resultMap="MyEmpByStep">
		select * from tbl_employee where id=#{id}
	</select>
	
</mapper>